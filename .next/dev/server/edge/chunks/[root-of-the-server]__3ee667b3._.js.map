{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/VSCode/wedd-inv/lib/supabase/middleware.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { NextResponse, type NextRequest } from \"next/server\"\n\nexport async function updateSession(request: NextRequest) {\n  let supabaseResponse = NextResponse.next({ request })\n\n  const isLoginPage = request.nextUrl.pathname === \"/admin/login\"\n  const isPublicRoute = !request.nextUrl.pathname.startsWith(\"/admin\")\n\n  if (isPublicRoute || isLoginPage) {\n    return supabaseResponse\n  }\n\n  // Only check auth for protected admin routes (not login)\n  try {\n    const supabaseUrl = process.env.SUPABASE_URL\n    const supabaseKey = process.env.SUPABASE_ANON_KEY\n\n    if (!supabaseUrl || !supabaseKey) {\n      // If no Supabase config, allow access (dev mode)\n      return supabaseResponse\n    }\n\n    const supabase = createServerClient(supabaseUrl, supabaseKey, {\n      cookies: {\n        getAll() {\n          return request.cookies.getAll()\n        },\n        setAll(cookiesToSet) {\n          cookiesToSet.forEach(({ name, value }) => request.cookies.set(name, value))\n          supabaseResponse = NextResponse.next({ request })\n          cookiesToSet.forEach(({ name, value, options }) => supabaseResponse.cookies.set(name, value, options))\n        },\n      },\n    })\n\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    // Redirect to login if not authenticated on protected admin routes\n    if (!user) {\n      const url = request.nextUrl.clone()\n      url.pathname = \"/admin/login\"\n      return NextResponse.redirect(url)\n    }\n  } catch (error) {\n    console.error(\"Middleware error:\", error)\n    // On error, redirect to login for admin routes\n    const url = request.nextUrl.clone()\n    url.pathname = \"/admin/login\"\n    return NextResponse.redirect(url)\n  }\n\n  return supabaseResponse\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAEO,eAAe,cAAc,OAAoB;IACtD,IAAI,mBAAmB,wVAAY,CAAC,IAAI,CAAC;QAAE;IAAQ;IAEnD,MAAM,cAAc,QAAQ,OAAO,CAAC,QAAQ,KAAK;IACjD,MAAM,gBAAgB,CAAC,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAE3D,IAAI,iBAAiB,aAAa;QAChC,OAAO;IACT;IAEA,yDAAyD;IACzD,IAAI;QACF,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;QAC5C,MAAM,cAAc,QAAQ,GAAG,CAAC,iBAAiB;QAEjD,IAAI,CAAC,eAAe,CAAC,aAAa;YAChC,iDAAiD;YACjD,OAAO;QACT;QAEA,MAAM,WAAW,IAAA,6UAAkB,EAAC,aAAa,aAAa;YAC5D,SAAS;gBACP;oBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;gBAC/B;gBACA,QAAO,YAAY;oBACjB,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,GAAK,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;oBACpE,mBAAmB,wVAAY,CAAC,IAAI,CAAC;wBAAE;oBAAQ;oBAC/C,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,iBAAiB,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;gBAC/F;YACF;QACF;QAEA,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,mEAAmE;QACnE,IAAI,CAAC,MAAM;YACT,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;YACjC,IAAI,QAAQ,GAAG;YACf,OAAO,wVAAY,CAAC,QAAQ,CAAC;QAC/B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,+CAA+C;QAC/C,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,OAAO,wVAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO;AACT"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/VSCode/wedd-inv/middleware.ts"],"sourcesContent":["import { NextResponse, type NextRequest } from \"next/server\"\n\nexport async function middleware(request: NextRequest) {\n  const isPublicRoute = !request.nextUrl.pathname.startsWith(\"/admin\") || request.nextUrl.pathname === \"/admin/login\"\n\n  if (isPublicRoute) {\n    return NextResponse.next()\n  }\n\n  // For protected admin routes, dynamically import and use session update\n  try {\n    const { updateSession } = await import(\"@/lib/supabase/middleware\")\n    return await updateSession(request)\n  } catch (error) {\n    console.error(\"Middleware error:\", error)\n    // If middleware fails, redirect to login\n    const url = request.nextUrl.clone()\n    url.pathname = \"/admin/login\"\n    return NextResponse.redirect(url)\n  }\n}\n\nexport const config = {\n  matcher: [\"/admin/:path*\"],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,gBAAgB,CAAC,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,QAAQ,OAAO,CAAC,QAAQ,KAAK;IAErG,IAAI,eAAe;QACjB,OAAO,wVAAY,CAAC,IAAI;IAC1B;IAEA,wEAAwE;IACxE,IAAI;QACF,MAAM,EAAE,aAAa,EAAE,GAAG;QAC1B,OAAO,MAAM,cAAc;IAC7B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,yCAAyC;QACzC,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,OAAO,wVAAY,CAAC,QAAQ,CAAC;IAC/B;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAgB;AAC5B"}}]
}